<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="default.css" >
        <link rel="icon" 
            type="image/png" 
            href="favicon.png">
        <script src="https://kit.fontawesome.com/a4eb36f3a7.js" crossorigin="anonymous"></script>
    </head>
    </style>
    <body>
        <header class="main-header">
            <div class="main-header__logo">
                <a href="index.html"><img src="son_of_man_round_small.png"/></a>
            </div>
            <nav>
                <ul>
                    <a href="https://github.com/regnull/ubikom"><i class="fa-brands fa-github fa-xl"></i></a>
                </ul>
            </nav>
        </header>
        <div class="content"> 
            <h1>Blockchain-Powered Digital Identity for Secure Communications</h1>

            <p> Email based on Self-Sovereign Identity (SSI) offers a powerful
                combination of security, privacy, and convenience for online
                interactions. With SSI, you can take control of your personal
                information and manage your own unique digital identity. Your
                identity is registered on the Ethereum blockchain, providing a
                tamper-proof and secure solution that integrates seamlessly with
                other blockchain-based services and applications. This means that
                you can enjoy more secure and streamlined online interactions, while
                maintaining control over your personal information. Say goodbye to
                the hassle of filling out forms and trusting companies with your
                sensitive data, and say hello to the future of email with
                self-sovereign identity.</p>

            <h2>Choose Your Name</h2>

            <p id="network" class="status-text"></p>
            <form id="name-form">
                <input type="text" id="identifier" placeholder="identifier (i.e. bob)" autocomplete="off"/>
                <button name="submit" id="nextButton">Next</button>
                <i><p id="status" style="margin: 0"></p></i>
            </form>
            <p class="description-text">Identifier must be a single word, only letters, numbers and symbols "_" and "-" are allowed.</p>
            <h2>Set Up Email</h2>
            <p>
                If you already have a registered name, you can start using Ubikom email. 
                Any email client supporting standard protocols (IMAP and SMTP) will work. 
            </p>
            <p><a href="clients.html">How to configure email clients</a></p>

            <h2>Tools</h2>
            <table class="tools__table">
                <tr class="tools__table_row">
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-user-secret" style="margin-right: 8px;"></i><a href="name_reg.html">Check name registration</a>
                    </td>
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-key" style="margin-right: 8px;"></i><a href="change_enckey.html">Change password (encryption key)</a>
                    </td>
                </tr>
                <tr class="tools__table_row">
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-arrow-right-long" style="margin-right: 8px;"></i><a href="register_endpoint.html">Update endpoint</a>
                    </td>
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-sack-dollar" style="margin-right: 8px;"></i><a href="sell_name.html">Sell a name</a>
                    </td>
                </tr>
                <tr class="tools__table_row">
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-cart-shopping" style="margin-right: 8px;"></i><a href="buy_name.html">Buy a name</a>
                    </td>
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-glasses" style="margin-right: 8px;"></i><a href="register_name_with_public_key.html">Register name and specify public key (advanced)</a>
                    </td>
                <tr class="tools__table_row">
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-check" style="margin-right: 8px;"></i><a href="check_mailbox.html">Check mailbox encryption (advanced)</a>
                    </td>
                    <td class="tools__table_cell">
                        <i class="fa-solid fa-gears" style="margin-right: 8px;"></i><a href="check_encryption_key.html">Check encryption key (advanced)</a>
                    </td>
                </tr>
            </table>
            <h2>Support the Project</h2>
            <p>
                Donate ETH to <a href="https://etherscan.io/address/0x7513bf6b503f69f8abAc1D404eE668Fb8D307Fa1" target="_blank">0x7513bf6b503f69f8abAc1D404eE668Fb8D307Fa1</a>
            </p>
            <p><img src="images/support-address.png"/> </p>
            <h2>Find out more</h2>
            <p><a href="intro.html" target="_blank" rel="noopener noreferrer">Let's Reinvent Email</a></p>
            <p><a href="beyond_email.html" target="_blank" rel="noopener noreferrer">Beyond Email</a></p>

            <p><a href="tech-description.html" target="_blank" rel="noopener noreferrer">Technical Description</a></p>

            <h2>Get on board, get in touch</h2>
            <p>GitHub repo: <a href="https://github.com/regnull/ubikom">github.com/regnull/ubikom</a> (developers are welcome to
                contribute).</p>
            <p>Contact: <a href="mailto: lgx@ubikom.cc">lgx@ubikom.cc</a>; <a href="mailto: sasha@ubikom.cc">sasha@ubikom.cc</a>
            </p>
            <p>On twitter: <a href="https://twitter.com/UbikomProject">@UbikomProject</a> (yes, using Twitter does strike us as
                ironic).</p>
            <p>Join our Reddit community: <a href="https://www.reddit.com/r/ubikom/">Ubikom on Reddit</a></p>
    </div>
    <script src ="scripts/common.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js" type="text/javascript"></script>
    <script>
        function submit(event) {
            event.preventDefault();
            if (!nextEnabled) {
                return;
            }
            let name = document.getElementById('identifier').value;
            location.href = `register_name.html?name=${name}`;
        }

        function setStatus(msg, color) {
            let status = document.getElementById("status");
            status.innerHTML = msg;
            status.style.color = color;
        }

        function clearStatus() {
            document.getElementById("status").innerHTML = " ";
        }

        function enableNext(enable) {
            if (enable) {
                document.getElementById('nextButton').style.opacity = 1.0;
                nextEnabled = true;
                return;
            }
            document.getElementById('nextButton').style.opacity = 0.6;
            nextEnabled = false;
        }

        document.getElementById("network").innerHTML = `Using ${getNetworkName()}`;

        const web3 = new Web3(getInfuraUrl());
        const nameRegistry = new web3.eth.Contract(nameRegistryContractAbi, getContractAddress());

        let nameHandler = new NameHandler(document.getElementById("identifier").value, nameRegistry, (o) => {
            clearStatus();

            if (o.error) {
                setStatus(o.error, '#FF0000');
                enableNext(false);
                return;
            }

            if (o.available) {
                setStatus("available!", '#3ADF00');
                enableNext(true);
            } else {
                let price = weiToEth(o.price);
                let forSaleStr = 'not for sale';
                if (o.price != 0) {
                    forSaleStr = `for sale for <a href="buy_name.html?name=${o.name}">${price} ETH</a>`;
                }
                setStatus(`owned by <a href='${getEtherscanAddressUrl(o.owner)}' target='_blank'>${o.owner}</a>, ` +
                    forSaleStr, '#FF0000');
                enableNext(false);
            }
        });

        let nextEnabled = false;

        let idInput = document.getElementById("identifier");
        idInput.onkeyup = () => {
            nameHandler.updateName(idInput.value);
        };
        enableNext(false);
        document.getElementById('nextButton').onclick = submit;
    </script>
    </body>
</html>
